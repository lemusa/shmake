-- ============================================================================
-- SHMAKE — Complete Supabase Migration
-- 001_initial_schema.sql
--
-- Tables (18), RLS policies, triggers, and seed data.
-- Runnable in Supabase SQL Editor in one go.
-- ============================================================================


-- ============================================================================
-- 1. TRIGGER FUNCTION
-- ============================================================================

CREATE OR REPLACE FUNCTION update_updated_at()
RETURNS TRIGGER AS $$
BEGIN NEW.updated_at = now(); RETURN NEW;
END; $$ LANGUAGE plpgsql;


-- ============================================================================
-- 2. TABLES (in FK dependency order)
-- ============================================================================

-- --------------------------------------------------------------------------
-- 2.1  clients
-- --------------------------------------------------------------------------
CREATE TABLE clients (
  id          bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name        text NOT NULL,
  email       text,
  phone       text,
  address     text,
  created_at  timestamptz DEFAULT now(),
  updated_at  timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.2  contacts
-- --------------------------------------------------------------------------
CREATE TABLE contacts (
  id          bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name        text NOT NULL,
  company     text,
  email       text,
  phone       text,
  type        text,
  tags        jsonb DEFAULT '[]'::jsonb,
  notes       text,
  created_at  timestamptz DEFAULT now(),
  updated_at  timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.3  jobs  (FK -> clients)
-- --------------------------------------------------------------------------
CREATE TABLE jobs (
  id            bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  title         text NOT NULL,
  client_id     bigint REFERENCES clients(id),
  type          text,
  status        text DEFAULT 'Enquiry',
  priority      text DEFAULT 'Medium',
  value         numeric(12,2) DEFAULT 0,
  due_date      date,
  description   text,
  internal_note text,
  created_at    timestamptz DEFAULT now(),
  updated_at    timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.4  quotes  (FK -> clients, jobs) — TEXT primary key
-- --------------------------------------------------------------------------
CREATE TABLE quotes (
  id            text PRIMARY KEY,
  client_id     bigint REFERENCES clients(id),
  job_id        bigint REFERENCES jobs(id),
  amount        numeric(12,2) DEFAULT 0,
  gst           numeric(12,2) DEFAULT 0,
  status        text DEFAULT 'Draft',
  date          date,
  expiry_date   date,
  version       int DEFAULT 1,
  external_note text,
  internal_note text,
  created_at    timestamptz DEFAULT now(),
  updated_at    timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.5  quote_line_items  (FK -> quotes CASCADE)
-- --------------------------------------------------------------------------
CREATE TABLE quote_line_items (
  id          bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  quote_id    text REFERENCES quotes(id) ON DELETE CASCADE,
  description text,
  type        text DEFAULT 'Labour',
  quantity    numeric(10,2) DEFAULT 1,
  unit_price  numeric(12,2) DEFAULT 0,
  total       numeric(12,2) DEFAULT 0,
  sort_order  int DEFAULT 0
);

-- --------------------------------------------------------------------------
-- 2.6  recurring_templates  (FK -> clients)
-- --------------------------------------------------------------------------
CREATE TABLE recurring_templates (
  id              bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  client_id       bigint REFERENCES clients(id),
  description     text,
  amount          numeric(12,2) DEFAULT 0,
  gst             numeric(12,2) DEFAULT 0,
  frequency       text DEFAULT 'Monthly',
  next_date       date,
  status          text DEFAULT 'Active',
  generated_count int DEFAULT 0,
  created_at      timestamptz DEFAULT now(),
  updated_at      timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.7  invoices  (FK -> clients, recurring_templates, quotes) — TEXT PK
-- --------------------------------------------------------------------------
CREATE TABLE invoices (
  id                    text PRIMARY KEY,
  client_id             bigint REFERENCES clients(id),
  recurring_template_id bigint REFERENCES recurring_templates(id),
  linked_quote_id       text REFERENCES quotes(id),
  amount                numeric(12,2) DEFAULT 0,
  gst                   numeric(12,2) DEFAULT 0,
  status                text DEFAULT 'Draft',
  date                  date,
  due_date              date,
  external_note         text,
  internal_note         text,
  payment_date          date,
  payment_method        text,
  payment_reference     text,
  created_at            timestamptz DEFAULT now(),
  updated_at            timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.8  invoice_line_items  (FK -> invoices CASCADE)
-- --------------------------------------------------------------------------
CREATE TABLE invoice_line_items (
  id          bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  invoice_id  text REFERENCES invoices(id) ON DELETE CASCADE,
  description text,
  type        text DEFAULT 'Labour',
  quantity    numeric(10,2) DEFAULT 1,
  unit_price  numeric(12,2) DEFAULT 0,
  total       numeric(12,2) DEFAULT 0,
  sort_order  int DEFAULT 0
);

-- --------------------------------------------------------------------------
-- 2.9  expenses  (FK -> jobs, contacts)
-- --------------------------------------------------------------------------
CREATE TABLE expenses (
  id                  bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  date                date NOT NULL,
  description         text NOT NULL,
  amount              numeric(12,2) NOT NULL,
  gst                 numeric(12,2) DEFAULT 0,
  category            text,
  job_id              bigint REFERENCES jobs(id),
  supplier_contact_id bigint REFERENCES contacts(id),
  has_receipt         boolean DEFAULT false,
  auto_imported       boolean DEFAULT false,
  apportioned         boolean DEFAULT false,
  full_amount         numeric(12,2),
  business_percent    int,
  receipt_url         text,
  internal_note       text,
  created_at          timestamptz DEFAULT now(),
  updated_at          timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.10 trips
-- --------------------------------------------------------------------------
CREATE TABLE trips (
  id            bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  date          date NOT NULL,
  from_location text,
  to_location   text,
  km            numeric(8,1) DEFAULT 0,
  purpose       text,
  category      text,
  created_at    timestamptz DEFAULT now(),
  updated_at    timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.11 home_office_expenses
-- --------------------------------------------------------------------------
CREATE TABLE home_office_expenses (
  id               bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  month            text NOT NULL,
  type             text NOT NULL,
  full_amount      numeric(12,2) DEFAULT 0,
  business_percent int DEFAULT 10,
  deductible       numeric(12,2) DEFAULT 0,
  created_at       timestamptz DEFAULT now(),
  updated_at       timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.12 subscription_sources
-- --------------------------------------------------------------------------
CREATE TABLE subscription_sources (
  id          bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  app_name    text NOT NULL,
  platform    text DEFAULT 'Stripe',
  subscribers int DEFAULT 0,
  mrr         numeric(12,2) DEFAULT 0,
  metadata    jsonb DEFAULT '{}'::jsonb,
  created_at  timestamptz DEFAULT now(),
  updated_at  timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.13 stripe_transactions  (FK -> subscription_sources) — TEXT PK
-- --------------------------------------------------------------------------
CREATE TABLE stripe_transactions (
  id                     text PRIMARY KEY,
  subscription_source_id bigint REFERENCES subscription_sources(id),
  date                   date,
  type                   text,
  gross                  numeric(12,2),
  fee                    numeric(12,2),
  net                    numeric(12,2),
  description            text,
  created_at             timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.14 bank_transactions
-- --------------------------------------------------------------------------
CREATE TABLE bank_transactions (
  id           bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  date         date,
  description  text,
  amount       numeric(12,2),
  matched_text text,
  created_at   timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.15 portfolio_projects
-- --------------------------------------------------------------------------
CREATE TABLE portfolio_projects (
  id               bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  title            text NOT NULL,
  category         jsonb DEFAULT '[]'::jsonb,
  description      text,
  long_description text,
  gradient         text DEFAULT 'gradient-amber',
  year             text,
  started          int,
  image            text,
  gallery          jsonb DEFAULT '[]'::jsonb,
  specs            jsonb DEFAULT '[]'::jsonb,
  skills           jsonb,
  sort_order       int DEFAULT 0,
  created_at       timestamptz DEFAULT now(),
  updated_at       timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.16 portfolio_categories
-- --------------------------------------------------------------------------
CREATE TABLE portfolio_categories (
  id          bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name        text UNIQUE NOT NULL,
  description text,
  sort_order  int DEFAULT 0
);

-- --------------------------------------------------------------------------
-- 2.17 hero_cards
-- --------------------------------------------------------------------------
CREATE TABLE hero_cards (
  id                 bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  key                text UNIQUE NOT NULL,
  title              text NOT NULL,
  logo               text,
  screenshot         text,
  description        text,
  link_text          text,
  link_href          text,
  is_internal        boolean DEFAULT false,
  initially_expanded boolean DEFAULT false,
  bg_style           text,
  sort_order         int DEFAULT 0,
  created_at         timestamptz DEFAULT now(),
  updated_at         timestamptz DEFAULT now()
);

-- --------------------------------------------------------------------------
-- 2.18 site_content  (singleton)
-- --------------------------------------------------------------------------
CREATE TABLE site_content (
  id         int PRIMARY KEY DEFAULT 1 CHECK (id = 1),
  about      jsonb DEFAULT '{}'::jsonb,
  contact    jsonb DEFAULT '{}'::jsonb,
  meta       jsonb DEFAULT '{}'::jsonb,
  business   jsonb DEFAULT '{}'::jsonb,
  invoicing  jsonb DEFAULT '{}'::jsonb,
  deductions jsonb DEFAULT '{}'::jsonb,
  categories jsonb DEFAULT '{}'::jsonb,
  updated_at timestamptz DEFAULT now()
);


-- ============================================================================
-- 3. ROW LEVEL SECURITY
-- ============================================================================

-- Enable RLS and create admin_all policy on every table
ALTER TABLE clients              ENABLE ROW LEVEL SECURITY;
ALTER TABLE contacts             ENABLE ROW LEVEL SECURITY;
ALTER TABLE jobs                 ENABLE ROW LEVEL SECURITY;
ALTER TABLE quotes               ENABLE ROW LEVEL SECURITY;
ALTER TABLE quote_line_items     ENABLE ROW LEVEL SECURITY;
ALTER TABLE recurring_templates  ENABLE ROW LEVEL SECURITY;
ALTER TABLE invoices             ENABLE ROW LEVEL SECURITY;
ALTER TABLE invoice_line_items   ENABLE ROW LEVEL SECURITY;
ALTER TABLE expenses             ENABLE ROW LEVEL SECURITY;
ALTER TABLE trips                ENABLE ROW LEVEL SECURITY;
ALTER TABLE home_office_expenses ENABLE ROW LEVEL SECURITY;
ALTER TABLE subscription_sources ENABLE ROW LEVEL SECURITY;
ALTER TABLE stripe_transactions  ENABLE ROW LEVEL SECURITY;
ALTER TABLE bank_transactions    ENABLE ROW LEVEL SECURITY;
ALTER TABLE portfolio_projects   ENABLE ROW LEVEL SECURITY;
ALTER TABLE portfolio_categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE hero_cards           ENABLE ROW LEVEL SECURITY;
ALTER TABLE site_content         ENABLE ROW LEVEL SECURITY;

-- Authenticated users get full access to all tables
CREATE POLICY "admin_all" ON clients              FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON contacts             FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON jobs                 FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON quotes               FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON quote_line_items     FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON recurring_templates  FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON invoices             FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON invoice_line_items   FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON expenses             FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON trips                FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON home_office_expenses FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON subscription_sources FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON stripe_transactions  FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON bank_transactions    FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON portfolio_projects   FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON portfolio_categories FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON hero_cards           FOR ALL TO authenticated USING (true) WITH CHECK (true);
CREATE POLICY "admin_all" ON site_content         FOR ALL TO authenticated USING (true) WITH CHECK (true);

-- Public (anon) read access for portfolio / public-facing tables
CREATE POLICY "anon_read" ON portfolio_projects   FOR SELECT TO anon USING (true);
CREATE POLICY "anon_read" ON portfolio_categories FOR SELECT TO anon USING (true);
CREATE POLICY "anon_read" ON hero_cards           FOR SELECT TO anon USING (true);
CREATE POLICY "anon_read" ON site_content         FOR SELECT TO anon USING (true);


-- ============================================================================
-- 4. TRIGGERS  (updated_at on all tables that have the column)
-- ============================================================================

CREATE TRIGGER set_updated_at BEFORE UPDATE ON clients              FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON contacts             FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON jobs                 FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON quotes               FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON recurring_templates  FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON invoices             FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON expenses             FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON trips                FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON home_office_expenses FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON subscription_sources FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON portfolio_projects   FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON hero_cards           FOR EACH ROW EXECUTE FUNCTION update_updated_at();
CREATE TRIGGER set_updated_at BEFORE UPDATE ON site_content         FOR EACH ROW EXECUTE FUNCTION update_updated_at();


-- ============================================================================
-- 5. SEED DATA
-- ============================================================================

-- --------------------------------------------------------------------------
-- 5.1  Clients
-- --------------------------------------------------------------------------
INSERT INTO clients (id, name, email, phone, address) VALUES
  (1, 'Sarah & Mark Thompson', 'sarah.mark@gmail.com', '027 555 1234', '14 Tainui St, Greymouth'),
  (2, 'Greymouth Kayaks Ltd', 'info@greymouthkayaks.co.nz', '03 555 2345', '8 Wharf St, Greymouth'),
  (3, 'West Coast Community Trust', 'admin@wcct.org.nz', '03 555 3456', 'PO Box 45, Greymouth'),
  (4, 'BuildRight Construction', 'orders@buildright.co.nz', '027 555 4567', '22 Industrial Pl'),
  (5, 'Ecoglo International', 'trevor@ecoglo.com', '03 555 5678', '15 Sir Gil Simpson Dr, Chch'),
  (6, 'Adventure Moto NZ', 'parts@adventuremoto.nz', '021 555 6789', '5 Arthur St, Hokitika');

-- --------------------------------------------------------------------------
-- 5.2  Contacts
-- --------------------------------------------------------------------------
INSERT INTO contacts (id, name, company, email, phone, type, tags, notes) VALUES
  (1, 'Dave Murray', 'Metalcraft Engineering', 'dave@metalcraft.co.nz', '03 768 1234', 'Supplier', '["steel","fab"]'::jsonb, 'Good turnaround. Trade >$500.'),
  (2, 'Karen Liu', 'Bunnings Greymouth', NULL, '03 768 2345', 'Supplier', '["hardware"]'::jsonb, 'Trade account set up.'),
  (3, 'Mike Te Huia', 'Freelance', 'mike@mikedesign.co.nz', '027 555 9876', 'Contractor', '["design"]'::jsonb, '$65/hr overflow.'),
  (4, 'Rachel Simmons', 'Simmons Accounting', 'rachel@simmonsaccounting.co.nz', '03 768 4567', 'Professional', '["tax"]'::jsonb, 'IR3 checklist Feb.'),
  (5, 'Tony Chen', 'WC Powdercoating', 'tony@wcpc.co.nz', '03 768 5678', 'Supplier', '["finish"]'::jsonb, 'Min 10pcs. 5 days.'),
  (6, 'James Porter', 'Porter Electrical', 'james@porter.co.nz', '027 555 3210', 'Trade', '["electrical"]'::jsonb, 'Sparky sign-off.');

-- --------------------------------------------------------------------------
-- 5.3  Jobs
-- --------------------------------------------------------------------------
INSERT INTO jobs (id, title, client_id, type, status, priority, value, due_date, internal_note) VALUES
  (1, 'Custom Timber Shelving Unit', 1, 'Fabrication', 'In Progress', 'High', 2400, '2026-02-28', 'Delivery confirmed for 28th'),
  (2, 'Logo Design — Greymouth Kayaks', 2, 'Design', 'Quoted', 'Medium', 800, '2026-03-15', NULL),
  (3, 'Workshop Consultation', 3, 'Consulting', 'Enquiry', 'Low', 450, NULL, 'Waiting for Ruth to confirm'),
  (4, 'Steel Bracket Fab x24', 4, 'Fabrication', 'Approved', 'High', 1800, '2026-02-20', NULL),
  (5, 'Ecoglo Monthly Consult', 5, 'Consulting', 'Invoiced', 'Medium', 300, '2026-01-31', NULL),
  (6, 'Motorcycle Pannier Mounts', 6, 'Fabrication', 'Complete', 'Medium', 650, '2026-01-20', NULL);

-- --------------------------------------------------------------------------
-- 5.4  Quotes
-- --------------------------------------------------------------------------
INSERT INTO quotes (id, client_id, job_id, amount, gst, status, date, expiry_date, version, external_note, internal_note) VALUES
  ('Q-0008', 2, 2, 800, 120, 'Sent', '2026-01-30', '2026-03-01', 1, '2 revision rounds incl.', 'Budget tight.'),
  ('Q-0009', 4, 4, 1800, 270, 'Accepted', '2026-02-03', '2026-03-05', 1, '6mm mild steel.', NULL),
  ('Q-0007', 3, 3, 450, 67.5, 'Draft', '2026-02-10', NULL, 1, NULL, 'Waiting for Ruth.'),
  ('Q-0006', 1, 1, 2400, 360, 'Accepted', '2026-01-12', '2026-02-11', 2, 'Incl. material & install. Recycled rimu.', 'V1 was $2800.');

-- --------------------------------------------------------------------------
-- 5.5  Quote Line Items
-- --------------------------------------------------------------------------
INSERT INTO quote_line_items (quote_id, description, type, quantity, unit_price, total, sort_order) VALUES
  ('Q-0008', 'Logo design — Greymouth Kayaks', 'Labour', 1, 800, 800, 0),
  ('Q-0009', 'Steel bracket fabrication x24', 'Labour', 24, 75, 1800, 0),
  ('Q-0007', 'Workshop consultation — half day', 'Labour', 1, 450, 450, 0),
  ('Q-0006', 'Design and fabrication — recycled rimu shelving unit', 'Labour', 1, 1600, 1600, 0),
  ('Q-0006', 'Materials — recycled rimu timber, brackets, fixings', 'Materials', 1, 800, 800, 1);

-- --------------------------------------------------------------------------
-- 5.6  Recurring Templates
-- --------------------------------------------------------------------------
INSERT INTO recurring_templates (id, client_id, description, amount, gst, frequency, next_date, status, generated_count) VALUES
  (1, 5, 'Monthly Consultancy', 345, 45, 'Monthly', '2026-03-01', 'Active', 12),
  (2, 1, 'Maintenance (paused)', 150, 22.5, 'Quarterly', NULL, 'Paused', 3);

-- --------------------------------------------------------------------------
-- 5.7  Invoices
-- --------------------------------------------------------------------------
INSERT INTO invoices (id, client_id, recurring_template_id, linked_quote_id, amount, gst, status, date, due_date, external_note, internal_note) VALUES
  ('SHMAKE-0012', 5, 1, NULL, 345, 45, 'Paid', '2026-01-20', '2026-02-20', 'Monthly consult — Jan', NULL),
  ('SHMAKE-0013', 4, NULL, 'Q-0009', 2070, 270, 'Sent', '2026-02-01', '2026-02-20', 'Per Quote Q-0009.', 'Dave pays ~15th.'),
  ('SHMAKE-0014', 1, NULL, NULL, 1380, 180, 'Draft', '2026-02-10', NULL, NULL, '50% deposit.'),
  ('SHMAKE-0011', 6, NULL, NULL, 747.5, 97.5, 'Overdue', '2025-12-28', '2026-01-20', NULL, 'Chased 3 Feb. Chase again.'),
  ('SHMAKE-0010', 3, NULL, NULL, 517.5, 67.5, 'Paid', '2025-12-15', '2026-01-20', 'Half day workshop', NULL);

-- --------------------------------------------------------------------------
-- 5.8  Invoice Line Items
-- --------------------------------------------------------------------------
INSERT INTO invoice_line_items (invoice_id, description, type, quantity, unit_price, total, sort_order) VALUES
  ('SHMAKE-0012', 'Monthly consultancy — January', 'Labour', 1, 300, 300, 0),
  ('SHMAKE-0013', 'Steel bracket fabrication', 'Labour', 24, 75, 1800, 0),
  ('SHMAKE-0014', 'Timber shelving — 50% deposit', 'Labour', 1, 1200, 1200, 0),
  ('SHMAKE-0011', 'Motorcycle pannier mounts', 'Fabrication', 1, 650, 650, 0),
  ('SHMAKE-0010', 'Workshop consultation — half day', 'Labour', 1, 450, 450, 0);

-- --------------------------------------------------------------------------
-- 5.9  Expenses
-- --------------------------------------------------------------------------
INSERT INTO expenses (id, date, description, amount, gst, category, job_id, supplier_contact_id, has_receipt, auto_imported, apportioned, full_amount, business_percent) VALUES
  (1, '2026-02-08', 'Steel flat bar x4',     186.3,  24.3,  'Materials',   4, NULL, true,  false, false, NULL,  NULL),
  (2, '2026-02-05', 'Supabase Pro — Feb',     25,     0,     'Software',    NULL, NULL, false, false, false, NULL,  NULL),
  (3, '2026-02-01', 'Stripe Fees — Jan',      42.18,  0,     'Processing',  NULL, NULL, false, true,  false, NULL,  NULL),
  (4, '2026-01-30', 'Bunnings — drill bits',  67.8,   8.84,  'Tools',       NULL, NULL, true,  false, false, NULL,  NULL),
  (5, '2026-01-28', 'Z Energy — fuel',        22.5,   2.93,  'Vehicle',     NULL, NULL, true,  false, true,  90,    25),
  (6, '2026-01-15', 'Internet — Jan',         10.99,  1.43,  'Home Office', NULL, NULL, false, false, true,  109.9, 10);

-- --------------------------------------------------------------------------
-- 5.10 Trips
-- --------------------------------------------------------------------------
INSERT INTO trips (id, date, from_location, to_location, km, purpose, category) VALUES
  (1, '2026-02-10', 'Home',     'Metalcraft',        12,  'Steel pickup',    'Supplier'),
  (2, '2026-02-07', 'Workshop', 'BuildRight',        8,   'Bracket delivery','Client'),
  (3, '2026-02-03', 'Home',     'Bunnings',          6,   'Drill bits',      'Supplier'),
  (4, '2026-01-28', 'Home',     'Thompson residence',18,  'Site measure',    'Client'),
  (5, '2026-01-22', 'Workshop', 'WC Powdercoating',  22,  'Drop samples',   'Supplier'),
  (6, '2026-01-15', 'Home',     'Ecoglo Chch',       340, 'Monthly visit',   'Client');

-- --------------------------------------------------------------------------
-- 5.11 Home Office Expenses
-- --------------------------------------------------------------------------
INSERT INTO home_office_expenses (id, month, type, full_amount, business_percent, deductible) VALUES
  (1, 'Jan 2026', 'Internet',   109.9, 10, 10.99),
  (2, 'Jan 2026', 'Power',      245,   10, 24.5),
  (3, 'Jan 2026', 'Insurance',  185,   10, 18.5),
  (4, 'Dec 2025', 'Internet',   109.9, 10, 10.99),
  (5, 'Dec 2025', 'Power',      220,   10, 22),
  (6, 'Dec 2025', 'Insurance',  185,   10, 18.5);

-- --------------------------------------------------------------------------
-- 5.12 Subscription Sources
-- --------------------------------------------------------------------------
INSERT INTO subscription_sources (id, app_name, platform, subscribers, mrr, metadata) VALUES
  (1, 'myMECA', 'Stripe', 267, 1068, '{"grossJan":1068,"feesJan":62.14,"netJan":1005.86,"trend":[890,920,945,980,1010,1040,1068]}'::jsonb);

-- --------------------------------------------------------------------------
-- 5.13 Stripe Transactions
-- --------------------------------------------------------------------------
INSERT INTO stripe_transactions (id, subscription_source_id, date, type, gross, fee, net, description) VALUES
  ('ch_1', 1, '2026-01-31', 'charge', 4,    0.62, 3.38,    'myMECA monthly'),
  ('ch_2', 1, '2026-01-31', 'charge', 4,    0.62, 3.38,    'myMECA monthly'),
  ('ch_3', 1, '2026-01-30', 'charge', 4,    0.62, 3.38,    'myMECA monthly'),
  ('po_1', 1, '2026-02-01', 'payout', NULL, NULL, 1005.86, 'Payout to ••7890');

-- --------------------------------------------------------------------------
-- 5.14 Bank Transactions
-- --------------------------------------------------------------------------
INSERT INTO bank_transactions (id, date, description, amount, matched_text) VALUES
  (1, '2026-02-03', 'STRIPE PAYOUT',      1005.86, 'Stripe payout — Jan'),
  (2, '2026-02-01', 'BUILDRIGHT CONST',    2070,    'SHMAKE-0013'),
  (3, '2026-01-30', 'BUNNINGS GREYMOUTH',  -67.8,   'Expense #4'),
  (4, '2026-01-28', 'Z ENERGY',            -90,     NULL),
  (5, '2026-01-25', 'COUNTDOWN',           -145.2,  NULL);

-- --------------------------------------------------------------------------
-- 5.15 Portfolio Categories
-- --------------------------------------------------------------------------
INSERT INTO portfolio_categories (id, name, description, sort_order) VALUES
  (1, 'All', NULL, 0),
  (2, 'Business', 'Operations, compliance, and process improvement work from 13+ years in manufacturing. These cards represent the systems and workflows I''ve learnt, built or improved to keep businesses running efficiently.', 1),
  (3, 'Web/App Dev', 'Self-taught development skills applied to real problems. From internal tools to public-facing apps, I build software that solves specific operational challenges.', 2),
  (4, 'CAD', 'Design work spanning product development, shop drawings, and custom fabrication projects. I use CAD to validate a concept before issues are found during production.', 3),
  (5, 'Technology', 'Personal tech projects including home infrastructure, custom builds, and the kind of tinkering that keeps my problem-solving skills sharp.', 4),
  (6, 'DIY', 'Hands-on projects. Building things with my hands gives me perspective that translates directly to understanding manufacturing processes. Plus it''s fun!', 5);

-- --------------------------------------------------------------------------
-- 5.16 Hero Cards
-- --------------------------------------------------------------------------
INSERT INTO hero_cards (id, key, title, logo, screenshot, description, link_text, link_href, is_internal, initially_expanded, bg_style, sort_order) VALUES
  (1, 'shmake', 'Sam Haughey', 'assets/shmake-logo-dark.png', 'assets/profile.png',
   '<strong>Operations Manager</strong> with 13+ years in manufacturing. I build systems that work — ERP, quality, compliance, costing — and apps that solve real problems.',
   'View Portfolio →', '#portfolio', true, true,
   'linear-gradient(rgba(253, 135, 1, 0.85), rgba(253, 135, 1, 0.75)), url(''https://images.unsplash.com/photo-1581291518857-4e27b48ff24e?w=800&q=80'')',
   0),
  (2, 'mymeca', 'myMECA', 'assets/logo-mymeca.png', 'assets/splash-mymeca.png',
   'Got curious about healthcare payroll. Built an app. 250+ nurses use it daily to calculate their pay under the NZNO-HNZ collective agreement.',
   'Visit myMECA →', 'https://mymeca.nz', false, false,
   'linear-gradient(rgba(36, 172, 221, 0.85), rgba(36, 172, 221, 0.75)), url(''https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?w=800&q=80'')',
   1),
  (3, 'teabreak', 'TeaBreak', 'assets/logo-teabreak.png', 'assets/splash-teabreak.png',
   'Business operations app in development. A simple solution for the pesky admin tasks that small business owners don''t have time to think about.',
   'Coming Soon', '#', true, false,
   'linear-gradient(rgba(300, 300, 300, 0.85), rgba(100, 100, 100, 0.75)), url(''https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=800&q=80'')',
   2),
  (4, 'kiwislice', 'KiwiSlice', 'assets/kiwislice-logo.svg', 'assets/splash-kiwislice.png',
   'Personal budget app for Kiwis. Track income, expenses, assets and liabilities in one place. Run planning scenarios to see where you''re headed.',
   'Try the App →', 'https://kiwislice-app.vercel.app', false, false,
   'linear-gradient(rgba(165, 196, 77, 0.9), rgba(141, 182, 0, 0.85)), url(''https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=800&q=80'')',
   3);

-- --------------------------------------------------------------------------
-- 5.17 Portfolio Projects  (50 rows)
-- --------------------------------------------------------------------------

-- Project 0 — Sam Haughey (has skills jsonb)
INSERT INTO portfolio_projects (id, title, category, description, long_description, gradient, year, started, image, gallery, specs, skills, sort_order) VALUES
  (0, 'Sam Haughey', '[]'::jsonb,
   'Operations Manager with 13+ years in manufacturing. I build systems that work and apps that solve real problems.',
   'I''ve spent over a decade turning operational chaos into streamlined systems — from factory floors to ERP platforms to custom-built tools. I''m equally comfortable in a spreadsheet, a codebase, or a workshop.',
   'gradient-amber', '13+ Years', NULL, 'assets/profile.png', '[]'::jsonb, '[]'::jsonb,
   $skills$[{"title":"Operations & Manufacturing","blurb":"From raw materials to finished goods — I manage the entire production lifecycle. ERP systems, inventory, scheduling, and supplier relationships that keep factories running smoothly.","items":["Unleashed ERP implementation & daily management","BOM structuring for 500+ product variants","Production scheduling & capacity planning","Supplier management & procurement workflows"]},{"title":"Quality & Compliance","blurb":"Building products that meet standards and pass audits. ISO 9001, industry certifications, health & safety systems, and traceability that protects both the business and customers.","items":["ISO 9001 quality systems maintenance","FMA certification support","CodeMark compliance","SiteWise/SiteSafe health & safety","Batch traceability & recall procedures"]},{"title":"Finance & Costing","blurb":"Making sure the numbers work. Product costing, margin analysis, demand forecasting, and financial reporting that drives profitable decision-making.","items":["Xero for operational reporting & audit prep","Product costing & margin analysis","Demand forecasting models","Procurement budgeting & cost reduction"]},{"title":"Software & Automation","blurb":"When off-the-shelf doesn't cut it, I build it. React apps, database backends, workflow automation, and scripts that eliminate repetitive work.","items":["myMECA: React app with 250+ daily users","Adobe Illustrator batch scripting","Supabase & PostgreSQL backends","Workflow automation & integrations"]},{"title":"Technical & Design","blurb":"Bridging the gap between concept and reality. CAD modelling, graphic design, prototyping, and the technical infrastructure that supports it all.","items":["SketchUp CAD & shop drawings","Photoshop/Illustrator for packaging","Home server & network infrastructure","3D printing & prototyping"]}]$skills$::jsonb,
   0);

-- Projects 1-49 (all have skills = NULL)
INSERT INTO portfolio_projects (id, title, category, description, long_description, gradient, year, started, image, gallery, specs, skills, sort_order) VALUES
  (44, 'myMECA', '["Web/App Dev"]'::jsonb,
   'Healthcare payroll calculator used by 250+ nurses daily. Built with React and Supabase to decode the NZNO-HNZ collective agreement. This was my first public facing app with login, subscriptions, a complex bucketing system for rostered hours that respect the NZNO-HNZ agreement. Lots of learnings but positive community feedback has kept me motivated.',
   NULL, 'gradient-cyan', '2025', NULL,
   'assets/projects/app/mymeca/mymeca.png',
   '["assets/projects/app/mymeca/mymeca1.png","assets/projects/app/mymeca/mymeca2.png","assets/projects/app/mymeca/mymeca3.png","assets/projects/app/mymeca/mymeca4.png","assets/projects/app/mymeca/mymeca5.png"]'::jsonb,
   '[]'::jsonb, NULL, 1),

  (55, 'ERP & Accounting Integration', '["Business"]'::jsonb,
   'Day-to-day management of Unleashed ERP and Xero accounting. Inventory control, BOM management, purchase orders, and financial reporting for a Tier 1 IFRS entity.',
   NULL, 'gradient-slate', 'Ongoing', 2012,
   'assets/projects/business/xero.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 2),

  (16, 'ISO 9001 Quality Management', '["Business"]'::jsonb,
   '10+ years developing and maintaining quality management systems to achieve and retain ISO 9001 certification across multiple audit cycles.',
   NULL, 'gradient-emerald', 'Ongoing', 2012,
   'assets/projects/business/sai.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 3),

  (52, 'Sign Pricing Calculator', '["Business","Web/App Dev"]'::jsonb,
   'Complex pricing tool handling material nesting calculations, tier-based pricing structures, and quote generation for photoluminescent signage products.',
   NULL, 'gradient-emerald', '2025', 2025,
   'assets/projects/business/signcalc1.png',
   '["assets/projects/business/signcalc1.png","assets/projects/business/signcalc2.png"]'::jsonb,
   '[]'::jsonb, NULL, 4),

  (17, 'FMA Audit', '["Business"]'::jsonb,
   '10+ years operating in a Tier 1 FMA reporting entity, playing a key role in preparing for and passing annual audits.',
   NULL, 'gradient-emerald', 'Ongoing', 2012,
   'assets/projects/business/fma.png',
   '[]'::jsonb, '[]'::jsonb, NULL, 5),

  (46, 'Process Optimisation', '["Business"]'::jsonb,
   'Streamlining manufacturing workflows, reducing waste, and implementing quality systems across production lines.',
   NULL, 'gradient-blue', 'Ongoing', 2012,
   NULL,
   '[]'::jsonb, '[]'::jsonb, NULL, 6),

  (51, 'Illustrator Automation', '["Web/App Dev"]'::jsonb,
   'Custom Adobe Illustrator scripts automating sign manufacturing workflows at Ecoglo. Batch processing, layout generation, and production-ready file prep that saves hours of manual work.',
   NULL, 'gradient-amber', 'Ongoing', 2023,
   'assets/projects/business/illustrator.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 7),

  (47, 'Costing & Forecasting', '["Business"]'::jsonb,
   'Building pricing models, procurement systems, and demand forecasting tools for manufacturing operations.',
   NULL, 'gradient-emerald', 'Ongoing', 2012,
   NULL,
   '[]'::jsonb, '[]'::jsonb, NULL, 8),

  (33, 'CodeMark', '["Business"]'::jsonb,
   'Managing production of a CodeMarked product for NZ and AU markets. Covers procurement, initial certification, and ongoing monitoring audits.',
   NULL, 'gradient-emerald', 'Ongoing', 2022,
   'assets/projects/business/codemark.png',
   '[]'::jsonb, '[]'::jsonb, NULL, 9),

  (45, 'TeaBreak', '["Web/App Dev"]'::jsonb,
   'Business operations app in development. Tackling the admin tasks small business owners don''t have time to think about.',
   NULL, 'gradient-slate', '2026', NULL,
   'assets/projects/app/teabreak/teabreak1.png',
   '["assets/projects/app/teabreak/teabreak2.png","assets/projects/app/teabreak/teabreak3.png","assets/projects/app/teabreak/teabreak4.png","assets/projects/app/teabreak/teabreak5.png","assets/projects/app/teabreak/teabreak6.png"]'::jsonb,
   '[]'::jsonb, NULL, 10),

  (32, 'Air Certify', '["Business"]'::jsonb,
   'Established and maintain Known Shipper accreditation for air freight compliance.',
   NULL, 'gradient-emerald', 'Ongoing', 2022,
   'assets/projects/business/aircertify.png',
   '[]'::jsonb, '[]'::jsonb, NULL, 11),

  (54, 'Specifications', '["Business"]'::jsonb,
   'Develope comprehesive product specifications for procurement, manufacturing and QC of products',
   NULL, 'gradient-red', 'Ongoing', 2015,
   NULL,
   '[]'::jsonb, '[]'::jsonb, NULL, 12),

  (14, 'Product Traceability', '["Business"]'::jsonb,
   'Designed end-to-end traceability system mapping raw materials through to finished product dispatch.',
   NULL, 'gradient-emerald', '2012', NULL,
   'assets/projects/business/trace.png',
   '[]'::jsonb, '[]'::jsonb, NULL, 13),

  (13, 'Factory Layout', '["Business"]'::jsonb,
   '3D visualisation of factory floor layout and plant areas. Used for planning equipment placement and workflow optimisation.',
   NULL, 'gradient-pink', '2011', NULL,
   'assets/projects/business/factory.png',
   '[]'::jsonb, '[]'::jsonb, NULL, 14),

  (43, 'SHMAKE Website', '["Web/App Dev"]'::jsonb,
   'This portfolio site. Vanilla HTML/CSS/JS with scroll-snap sections, dark mode, and JSON-driven project data.',
   NULL, 'gradient-amber', '2025', NULL,
   'assets/projects/app/shmake/shmake1.png',
   '["assets/projects/app/shmake/shmake2.png","assets/projects/app/shmake/shmake3.png"]'::jsonb,
   '[]'::jsonb, NULL, 15),

  (27, 'SiteWise', '["Business"]'::jsonb,
   'SiteSafe and SiteWise certified. Developed and maintain OHS processes, incident reporting, and compliance documentation across manufacturing and field operations.',
   NULL, 'gradient-emerald', 'Ongoing', NULL,
   'assets/projects/business/sitewise.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 16),

  (38, 'LEMUSA MOTO', '["Web/App Dev"]'::jsonb,
   'A hobby site documenting my adventure riding passion. Trip logs, bike builds, and gear reviews.',
   NULL, 'gradient-slate', '2024', NULL,
   'assets/projects/app/lemusa/lemusa1.png',
   '["assets/projects/app/lemusa/lemusa2.png","assets/projects/app/lemusa/lemusa3.png","assets/projects/app/lemusa/lemusa4.png"]'::jsonb,
   '[]'::jsonb, NULL, 17),

  (1, 'ahoythere', '["Web/App Dev"]'::jsonb,
   'My very first website from 2006. Hand-coded HTML and CSS, hosted on free web hosting. Everyone starts somewhere.',
   NULL, 'gradient-slate', '2006', NULL,
   'assets/projects/app/ahoythere.png',
   '[]'::jsonb, '[]'::jsonb, NULL, 18),

  (49, 'Product Mock-ups', '["CAD"]'::jsonb,
   'Photoshop mock-ups and renders for product packaging, signage, and marketing materials.',
   NULL, 'gradient-violet', 'Ongoing', 2012,
   NULL,
   '[]'::jsonb, '[]'::jsonb, NULL, 19),

  (48, 'Shop Drawings', '["Business","CAD"]'::jsonb,
   'Component and generating shop drawings and version control, submittal processes in platforms like Aconex',
   NULL, 'gradient-lime', 'Ongoing', 2015,
   'assets/projects/business/shopdrawing.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 20),

  (41, 'Brackets', '["CAD"]'::jsonb,
   'Custom bracket designs for ute tray bars. Modelled in CAD before fabrication to ensure proper fit and load capacity.',
   NULL, 'gradient-amber', '2025', NULL,
   'assets/projects/cad/ute/ute1.png',
   '["assets/projects/cad/ute/ute2.png","assets/projects/cad/ute/ute3.png","assets/projects/cad/ute/ute4.png","assets/projects/cad/ute/ute5.png"]'::jsonb,
   '[]'::jsonb, NULL, 21),

  (39, 'Spa', '["CAD"]'::jsonb,
   '3D visualisation for finishing touches to an outdoor spa area. Helped the client see options before committing.',
   NULL, 'gradient-cyan', '2024', NULL,
   'assets/projects/cad/spa/spa1.png',
   '["assets/projects/cad/spa/spa2.jpg","assets/projects/cad/spa/spa3.jpg","assets/projects/cad/spa/spa4.png"]'::jsonb,
   '[]'::jsonb, NULL, 22),

  (31, 'Tiny Container Home', '["CAD"]'::jsonb,
   'Concept design for a compact dwelling using two 20ft shipping containers. Modelled in SketchUp with full interior layout.',
   NULL, 'gradient-pink', '2021', NULL,
   'assets/projects/cad/container/container1.jpg',
   '["assets/projects/cad/container/container2.jpg","assets/projects/cad/container/container3.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 23),

  (30, 'Entertainment Unit', '["CAD"]'::jsonb,
   'Floating TV unit designed in SketchUp. Tasmanian oak veneer with integrated cable management and hidden storage.',
   NULL, 'gradient-amber', '2021', NULL,
   NULL,
   '[]'::jsonb, '[]'::jsonb, NULL, 24),

  (29, 'Home Office', '["CAD"]'::jsonb,
   'Home office concept featuring built-in desk and floor-to-ceiling cabinetry. Designed to maximise a small space.',
   NULL, 'gradient-pink', '2021', NULL,
   'assets/projects/cad/office.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 25),

  (28, 'Business Card Template', '["CAD"]'::jsonb,
   'Business card design template for professional use.',
   NULL, 'gradient-pink', '2021', NULL,
   'assets/projects/graphic/flex.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 26),

  (24, 'Kitchen', '["CAD"]'::jsonb,
   '3D render of a kitchen renovation concept. Helped visualise layout changes and material choices before building.',
   NULL, 'gradient-pink', '2020', NULL,
   'assets/projects/cad/kitchen.png',
   '[]'::jsonb, '[]'::jsonb, NULL, 27),

  (35, 'Album Art', '["CAD"]'::jsonb,
   'Cover art for a local rock band.',
   NULL, 'gradient-pink', '2011', NULL,
   'assets/projects/graphic/cto.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 28),

  (12, 'Album Art', '["CAD"]'::jsonb,
   'Cover art for a local rock band.',
   NULL, 'gradient-pink', '2009', NULL,
   'assets/projects/graphic/ahi.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 29),

  (50, 'PC Builds', '["Technology"]'::jsonb,
   'Since 2007, I''ve built more gaming and workstation PCs than I can count. For myself, family, friends, and for resale.',
   NULL, 'gradient-blue', 'Ongoing', 2007,
   'assets/projects/tech/computers/2025.jpg',
   '["assets/projects/tech/computers/2023.jpg","assets/projects/tech/computers/2022.jpg","assets/projects/tech/computers/2021.jpg","assets/projects/tech/computers/2018a.jpg","assets/projects/tech/computers/2018b.jpg","assets/projects/tech/computers/2017.jpg","assets/projects/tech/computers/2009.jpg","assets/projects/tech/computers/2008.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 30),

  (42, 'Home Workstation', '["Technology"]'::jsonb,
   'An evolving setup balancing form and function. Multiple iterations over 15+ years of tweaking, upgrading, and starting fresh.',
   NULL, 'gradient-cyan', '2025', NULL,
   'assets/projects/tech/desks/2025.jpg',
   '["assets/projects/tech/desks/2022.jpg","assets/projects/tech/desks/2020.jpg","assets/projects/tech/desks/2017.jpg","assets/projects/tech/desks/2016.jpg","assets/projects/tech/desks/2015.jpg","assets/projects/tech/desks/2014.jpg","assets/projects/tech/desks/2012.jpg","assets/projects/tech/desks/2009.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 31),

  (37, 'Networking', '["Technology"]'::jsonb,
   'Enterprise-grade home network with managed switches, multiple VLANs, and UniFi access points for full coverage.',
   NULL, 'gradient-pink', '2023', NULL,
   'assets/projects/tech/network/network1.jpg',
   '["assets/projects/tech/network/network2.png","assets/projects/tech/network/network3.png"]'::jsonb,
   '["Ubiquiti EdgeRouter ER-4","TP-Link TL-SG1218MPE","Ubiquiti EdgeSwitch ES-48LITE","Ubiquiti UniFi UAP-AC-LR x 2"]'::jsonb,
   NULL, 32),

  (36, 'Home Server', '["Technology"]'::jsonb,
   'Unraid server handling NAS duties, NVR for security cameras, and running VMs for various services.',
   NULL, 'gradient-violet', '2023', NULL,
   'assets/projects/tech/server/server1.jpg',
   '["assets/projects/tech/server/server2.jpg","assets/projects/tech/server/server3.jpg","assets/projects/tech/server/server4.jpg","assets/projects/tech/server/server5.jpg"]'::jsonb,
   '["Unraid","Ryzen 2700X, 32GB RAM, GTX1070 passthrough","Emby, DuckDNS, Unifi, AgentDVR, Duplicacy","VMs for Windows 10, Windows 11, Linux"]'::jsonb,
   NULL, 33),

  (22, 'Rack Cases', '["Technology"]'::jsonb,
   'Custom 19" rack cases built from timber and steel. Houses server hardware in a more living-room-friendly package.',
   NULL, 'gradient-violet', '2019', NULL,
   'assets/projects/tech/servercase/server1.jpg',
   '["assets/projects/tech/servercase/server2.jpg","assets/projects/tech/servercase/server3.jpg","assets/projects/tech/servercase/server4.jpg","assets/projects/tech/servercase/server5.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 34),

  (18, 'HTPC', '["Technology"]'::jsonb,
   'Custom home theatre PC case built to match the entertainment unit. Sleek form factor with proper cooling and cable management.',
   NULL, 'gradient-violet', '2016', NULL,
   'assets/projects/tech/htpc/htpc1.jpg',
   '["assets/projects/tech/htpc/htpc2.jpg","assets/projects/tech/htpc/htpc3.jpg","assets/projects/tech/htpc/htpc4.jpg","assets/projects/tech/htpc/htpc5.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 35),

  (15, 'Sim Racing', '["Technology"]'::jsonb,
   'Custom sim rigs that started simple and escalated. Multiple iterations from a basic wheel stand to a full motion platform.',
   NULL, 'gradient-red', '2012-2023', NULL,
   'assets/projects/tech/sim/simv2a.jpg',
   '["assets/projects/tech/sim/simog.jpg","assets/projects/tech/sim/simv1a.jpg","assets/projects/tech/sim/simv1b.jpg","assets/projects/tech/sim/simv1c.jpg","assets/projects/tech/sim/simv1d.jpg","assets/projects/tech/sim/simv2b.jpg","assets/projects/tech/sim/simv2c.jpg","assets/projects/tech/sim/simv2d.jpg","assets/projects/tech/sim/simv2e.jpg","assets/projects/tech/sim/simv2f.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 36),

  (40, 'BBQ Area', '["DIY"]'::jsonb,
   'Outdoor BBQ area build with paving, timber features, and a dedicated cooking space for entertaining.',
   NULL, 'gradient-pink', '2024', NULL,
   'assets/projects/diy/bbq/bbq1.jpg',
   '["assets/projects/diy/bbq/bbq2.jpg","assets/projects/diy/bbq/bbq3.jpg","assets/projects/diy/bbq/bbq4.jpg","assets/projects/diy/bbq/bbq5.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 37),

  (19, 'Welding Cart', '["DIY"]'::jsonb,
   'A bit of inception - using the welder to build a cart for the welder',
   NULL, 'gradient-emerald', '2024', NULL,
   'assets/projects/diy/weldcart/weld1.jpg',
   '["assets/projects/diy/weldcart/weld2.jpg","assets/projects/diy/weldcart/weld3.jpg","assets/projects/diy/weldcart/weld4.jpg","assets/projects/diy/weldcart/weld5.jpg","assets/projects/diy/weldcart/weld6.jpg","assets/projects/diy/weldcart/weld7.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 38),

  (34, 'Small Deck Build', '["DIY"]'::jsonb,
   'Full deck construction from design through to completion. Concrete piles, posts, framing, and H4 decking.',
   NULL, 'gradient-yellow', '2022', NULL,
   'assets/projects/diy/decksmall/deck7.jpg',
   '["assets/projects/diy/decksmall/deck1.jpg","assets/projects/diy/decksmall/deck2.jpg","assets/projects/diy/decksmall/deck3.jpg","assets/projects/diy/decksmall/deck4.jpg","assets/projects/diy/decksmall/deck5.jpg","assets/projects/diy/decksmall/deck6.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 39),

  (341, 'Large Deck Build', '["DIY"]'::jsonb,
   'Full deck construction from design through to completion. Concrete piles, posts, framing, and H4 decking.',
   NULL, 'gradient-yellow', '2022', NULL,
   'assets/projects/diy/decklarge/deck1.jpg',
   '["assets/projects/diy/decklarge/deck2.jpg","assets/projects/diy/decklarge/deck3.jpg","assets/projects/diy/decklarge/deck4.jpg","assets/projects/diy/decklarge/deck5.jpg","assets/projects/diy/decklarge/deck6.jpg","assets/projects/diy/decklarge/deck7.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 40),

  (271, 'Shed', '["DIY"]'::jsonb,
   'Kitset shed build for a local special needs family',
   NULL, 'gradient-emerald', '2021', NULL,
   'assets/projects/diy/shed.jpg',
   '[]'::jsonb, '[]'::jsonb, NULL, 41),

  (276, 'Reception Desk', '["DIY"]'::jsonb,
   'Designed and built a custom reception desk with LED lighting',
   NULL, 'gradient-emerald', '2020', NULL,
   'assets/projects/diy/reception/desk1.jpg',
   '["assets/projects/diy/reception/desk2.png","assets/projects/diy/reception/desk3.jpg","assets/projects/diy/reception/desk4.jpg","assets/projects/diy/reception/desk5.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 42),

  (26, 'Arcade Machine', '["DIY"]'::jsonb,
   'Full-size arcade cabinet designed from scratch to house an old iMac running MAME.',
   NULL, 'gradient-emerald', '2020', NULL,
   'assets/projects/diy/arcade/arcade.jpg',
   '["assets/projects/diy/arcade/arcade1.jpg","assets/projects/diy/arcade/arcade2.jpg","assets/projects/diy/arcade/arcade3.jpg","assets/projects/diy/arcade/arcade4.jpg","assets/projects/diy/arcade/arcade5.jpg"]'::jsonb,
   '["Designed from scratch to house an old iMac","18mm MDF Construction","2-Player Controls","2.1 Audio"]'::jsonb,
   NULL, 43),

  (23, 'House Renovation', '["DIY"]'::jsonb,
   'Exterior modernisation with new cladding, windows, and landscaping to bring a dated house into the current decade.',
   NULL, 'gradient-emerald', '2019', NULL,
   'assets/projects/diy/house/house1.jpg',
   '["assets/projects/diy/house/house2.jpg","assets/projects/diy/house/house3.jpg","assets/projects/diy/house/house4.jpg","assets/projects/diy/house/house5.jpg","assets/projects/diy/house/house6.jpg","assets/projects/diy/house/house7.jpg","assets/projects/diy/house/house8.jpg","assets/projects/diy/house/house9.jpg","assets/projects/diy/house/house10.jpg","assets/projects/diy/house/house11.jpg","assets/projects/diy/house/house12.jpg","assets/projects/diy/house/house13.jpg","assets/projects/diy/house/house14.jpg","assets/projects/diy/house/house15.jpg","assets/projects/diy/house/house16.jpg","assets/projects/diy/house/house17.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 44),

  (25, 'Kitchen Upgrade', '["DIY"]'::jsonb,
   'Budget-friendly kitchen refresh with new cabinet doors, laminate benchtops, and tiled splashbacks. Removed hot water cylinder for gas conversion',
   NULL, 'gradient-emerald', '2018', NULL,
   'assets/projects/diy/kitchen/kitchen1.jpg',
   '["assets/projects/diy/kitchen/kitchen2.jpg","assets/projects/diy/kitchen/kitchen3.jpg","assets/projects/diy/kitchen/kitchen4.jpg","assets/projects/diy/kitchen/kitchen5.jpg","assets/projects/diy/kitchen/kitchen6.jpg","assets/projects/diy/kitchen/kitchen7.jpg","assets/projects/diy/kitchen/kitchen8.jpg","assets/projects/diy/kitchen/kitchen9.jpg","assets/projects/diy/kitchen/kitchen10.jpg","assets/projects/diy/kitchen/kitchen11.jpg","assets/projects/diy/kitchen/kitchen12.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 45),

  (500, 'Laundry Remodel', '["DIY"]'::jsonb,
   'Complete gut of the laundry, plumbing, cabinets, ventilation, shelving, backsplash',
   NULL, 'gradient-blue', '2018', 2018,
   'assets/projects/diy/laundry/laundry1.jpg',
   '["assets/projects/diy/laundry/laundry2.jpg","assets/projects/diy/laundry/laundry3.jpg","assets/projects/diy/laundry/laundry4.jpg","assets/projects/diy/laundry/laundry5.jpg","assets/projects/diy/laundry/laundry6.jpg","assets/projects/diy/laundry/laundry7.jpg","assets/projects/diy/laundry/laundry8.jpg","assets/projects/diy/laundry/laundry9.jpg","assets/projects/diy/laundry/laundry10.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 46),

  (21, 'Sound Bar', '["DIY"]'::jsonb,
   'Custom sound bar built from salvaged Rimu timber with quality drivers and a built-in amplifier.',
   NULL, 'gradient-violet', '2018', NULL,
   'assets/projects/diy/soundbar/soundbar1.jpg',
   '["assets/projects/diy/soundbar/soundbar2.jpg","assets/projects/diy/soundbar/soundbar3.jpg","assets/projects/diy/soundbar/soundbar4.jpg","assets/projects/diy/soundbar/soundbar5.jpg","assets/projects/diy/soundbar/soundbar6.jpg","assets/projects/diy/soundbar/soundbar7.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 47),

  (20, 'Boom Box', '["DIY"]'::jsonb,
   'Portable 2.1 speaker system built for more punch than off-the-shelf options. Runs on 12V for wall or car battery power.',
   NULL, 'gradient-violet', '2018', NULL,
   'assets/projects/diy/boombox/boombox1.jpg',
   '["assets/projects/diy/boombox/boombox2.jpg","assets/projects/diy/boombox/boombox3.jpg","assets/projects/diy/boombox/boombox4.jpg","assets/projects/diy/boombox/boombox5.jpg"]'::jsonb,
   '["2.1 Audio","12V power from wall or car battery"]'::jsonb,
   NULL, 48),

  (188, 'Cavity Slider', '["DIY"]'::jsonb,
   'Removed a dated ornamental sliding door and replaced it with a cavity slider.',
   NULL, 'gradient-violet', '2016', NULL,
   'assets/projects/diy/door/door1.jpg',
   '["assets/projects/diy/door/door2.jpg","assets/projects/diy/door/door3.jpg","assets/projects/diy/door/door4.jpg","assets/projects/diy/door/door5.jpg","assets/projects/diy/door/door6.jpg","assets/projects/diy/door/door7.jpg","assets/projects/diy/door/door8.jpg","assets/projects/diy/door/door9.jpg"]'::jsonb,
   '[]'::jsonb, NULL, 49);

-- --------------------------------------------------------------------------
-- 5.18 Site Content  (singleton — uses dollar-quoting for large JSON)
-- --------------------------------------------------------------------------
INSERT INTO site_content (id, about, contact, meta, business, invoicing, deductions, categories) VALUES (
  1,

  -- about
  $about${"name":"Sam Haughey","photo":"assets/profile.png","tagline":"I get curious, build things, then move on to the next problem.","taglineSub":"Expert at becoming almost an expert","bio":["Based in Christchurch with my wife and three daughters, I've spent the last 18 years working everywhere from the factory floor to construction sites, then into production scheduling and now operations management — looking after the day-to-day of a manufacturing company that ships product around the world. Along the way I've dabbled in freelance graphic, web, and CAD design.","I get obsessed with problems, binge-learn whatever I need to fix them, then wander off to the next curiosity. The upside is the knowledge sticks. I'm as comfortable with code as I am with power tools, Illustrator as I am with Excel, SketchUp as I am with generating SOP's.","For the last 13 years I've been the person who solves the operational headaches at Ecoglo International while building side projects that keep my brain busy. I get energised by new, odd, or tricky problems — the ones where the solution isn't obvious yet. If that's what you're working on, let's chat."],"skills":[{"title":"Digital","items":["Web development","React & Supabase","Adobe Creative Suite","Home automation"]},{"title":"Physical","items":["SketchUp & CAD","3D printing & CNC","Welding & fabrication","Construction & DIY"]},{"title":"Business","items":["Operations management","Process optimisation","Costing & forecasting","Quality systems"]},{"title":"Creative","items":["Video editing","Branding & layout","Product mock-ups","Workshop builds"]}]}$about$::jsonb,

  -- contact
  '{"formAction":"https://formspree.io/f/xldvwqal","recaptchaSiteKey":"6Ld4SBUsAAAAAA7SFAgUI5fFQ_IDMD16EcAkDOKe","heading":"Building something interesting?","subheading":"Always keen to hear about novel problems and interesting challenges.","socials":[{"type":"linkedin","url":"https://www.linkedin.com/in/samhaughey/","label":"LinkedIn"},{"type":"whatsapp","url":"https://wa.me/64274766268","label":"WhatsApp"}]}'::jsonb,

  -- meta
  '{"title":"SHMAKE - Build Things","gaId":"G-SQ07S188GB"}'::jsonb,

  -- business
  '{"tradingName":"SHMAKE","legalName":"Sam — Sole Trader","gstNumber":"123-456-789","irdNumber":"12-345-678","bank":"03-1234-0567890-00","email":"sam@shmake.nz"}'::jsonb,

  -- invoicing
  '{"invoicePrefix":"SHMAKE-","invoiceNextNumber":15,"quotePrefix":"Q-","quoteNextNumber":10,"terms":"20th following","gstPercent":15,"defaultNote":"Thank you for your business."}'::jsonb,

  -- deductions
  '{"homeOffice":{"officeSqm":12,"totalSqm":120,"percent":10},"vehicle":{"method":"IRD Km Rate","type":"Petrol","tier1":1.17,"tier2":0.37},"phonePercent":50,"internetPercent":10}'::jsonb,

  -- categories
  '{"expense":["Materials","Tools","Software","Vehicle","Home Office","Marketing","Processing","Other"],"jobTypes":["Fabrication","Design","Consulting","Other"],"contactTypes":["Supplier","Contractor","Trade","Professional","Other"]}'::jsonb
);


-- ============================================================================
-- 6. RESET IDENTITY SEQUENCES
-- ============================================================================

SELECT setval(pg_get_serial_sequence('clients',              'id'), COALESCE((SELECT MAX(id) FROM clients), 0));
SELECT setval(pg_get_serial_sequence('contacts',             'id'), COALESCE((SELECT MAX(id) FROM contacts), 0));
SELECT setval(pg_get_serial_sequence('jobs',                 'id'), COALESCE((SELECT MAX(id) FROM jobs), 0));
SELECT setval(pg_get_serial_sequence('quote_line_items',     'id'), COALESCE((SELECT MAX(id) FROM quote_line_items), 0));
SELECT setval(pg_get_serial_sequence('recurring_templates',  'id'), COALESCE((SELECT MAX(id) FROM recurring_templates), 0));
SELECT setval(pg_get_serial_sequence('invoice_line_items',   'id'), COALESCE((SELECT MAX(id) FROM invoice_line_items), 0));
SELECT setval(pg_get_serial_sequence('expenses',             'id'), COALESCE((SELECT MAX(id) FROM expenses), 0));
SELECT setval(pg_get_serial_sequence('trips',                'id'), COALESCE((SELECT MAX(id) FROM trips), 0));
SELECT setval(pg_get_serial_sequence('home_office_expenses', 'id'), COALESCE((SELECT MAX(id) FROM home_office_expenses), 0));
SELECT setval(pg_get_serial_sequence('subscription_sources', 'id'), COALESCE((SELECT MAX(id) FROM subscription_sources), 0));
SELECT setval(pg_get_serial_sequence('bank_transactions',    'id'), COALESCE((SELECT MAX(id) FROM bank_transactions), 0));
SELECT setval(pg_get_serial_sequence('portfolio_projects',   'id'), COALESCE((SELECT MAX(id) FROM portfolio_projects), 0));
SELECT setval(pg_get_serial_sequence('portfolio_categories', 'id'), COALESCE((SELECT MAX(id) FROM portfolio_categories), 0));
SELECT setval(pg_get_serial_sequence('hero_cards',           'id'), COALESCE((SELECT MAX(id) FROM hero_cards), 0));


-- ============================================================================
-- Done.
-- ============================================================================
